@page
@using RazorPagesMovie.Helpers
@model RazorPagesMovie.Pages.Movies.IndexModel

@{
    ViewData["Title"] = "Movies";
}

<p>
    <a asp-page="Create">Create New</a>
</p>

<form>
    <p>
        Filter by
        <select class="mr-4" name="genreTitle" asp-for="CurrentFilter" asp-items="Model.Genres">
            <option value="">All</option>
        </select>
        Search by title
        <input type="text" name="searchString" value="@Model.CurrentSearch" />
        <input type="submit" value="Filter" />
    </p>
</form>

<p>Number of movies found: @Model.MoviesCount</p>

<div class="card-columns">
    @foreach (var movie in Model.Movies)
    {
        <div class="card">
            <img class="card-img-top" src="~/images/@movie.Image" alt="Card image cap" style="height: 200px;" />
            <div class="card-body">
                <h4 class="card-title" style="font-family: 'Times New Roman', 'Times, serif;'">@movie.Title</h4>
                <div style="display: flex">
                    <div>
                        <blockquote class="blockquote card-text">
                            <p class="card-text text-secondary" style="font-family: 'Courier New';">@movie.Genre.GenreTitle</p>
                        </blockquote>
                        <a class="btn btn-info details-btn" style="margin-top: 15px;"
                           asp-page="./Details" asp-route-id="@movie.ID">See details</a>
                    </div>
                    <div class="ml-auto">
                        <p class="card-text text-right" style="font-family: Georgia">Rating: @movie.Rating</p>
                        <p class="card-text text-right" style="font-family: Georgia">Price: @movie.Price $</p>
                        <p class="card-text"><small class="text-muted">Release: @movie.ReleaseDate.ToString("dd-MM-yyyy")</small></p>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

@{
    var prevDisabled = !Model.Movies.HasPreviousPage ? "disabled" : "";
    var nextDisabled = !Model.Movies.HasNextPage ? "disabled" : "";
}

<a asp-page="./Index"
   asp-route-sortBy="@Model.CurrentSort"
   asp-route-genreTitle="@Model.CurrentFilter"
   asp-route-searchString="@Model.CurrentSearch"
   asp-route-pageIndex="@(Model.Movies.PageIndex - 1)"
   class="btn btn-primary @prevDisabled">
    Previous
</a>

<a asp-page="./Index"
   asp-route-sortBy="@Model.CurrentSort"
   asp-route-genreTitle="@Model.CurrentFilter"
   asp-route-searchString="@Model.CurrentSearch"
   asp-route-pageIndex="@(Model.Movies.PageIndex + 1)"
   class="btn btn-primary @nextDisabled">
    Next
</a>
